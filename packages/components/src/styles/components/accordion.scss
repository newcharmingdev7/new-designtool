/**
 * Copyright (c) HashiCorp, Inc.
 * SPDX-License-Identifier: MPL-2.0
 */

//
// ACCORDION
//

@use "../mixins/button" as *;
@use "../mixins/focus-ring" as *;

.hds-accordion {
  --hds-accordion-item-padding-large: 16px;
  --hds-accordion-item-padding-medium: 12px;
  --hds-accordion-item-padding-small: 8px;
  --hds-accordion-item-icon-large: 24px;
  --hds-accordion-item-icon-medium: 20px;
  --hds-accordion-item-icon-small: 16px;
  --hds-accordion-item-border-radius: 6px;
  --hds-accordion-item-gap: 12px;

  display: flex;
  flex-direction: column;
}

.hds-accordion--type-card {
  &.hds-accordion--size-large {
    gap: 12px;
  }

  &.hds-accordion--size-medium {
    gap: 8px;
  }

  &.hds-accordion--size-small {
    gap: 4px;
  }
}

// ACCORDION ITEM COMPONENT (nested child)

.hds-accordion-item--type-card {
  background: var(--token-color-surface-primary);
  border-radius: var(--hds-accordion-item-border-radius);

  &.hds-accordion-item--does-not-contain-interactive:not(.hds-accordion-item--is-static) {
    box-shadow: var(--token-surface-mid-box-shadow);

    &:hover,
    &.mock-hover {
      box-shadow: var(--token-surface-high-box-shadow);
    }
  }

  &.hds-accordion-item--contains-interactive,
  &.hds-accordion-item--is-static {
    box-shadow: var(--token-surface-base-box-shadow);
  }
}

.hds-accordion-item--type-flush {
  box-shadow: 0 1px 0 0 var(--token-color-border-primary);

  &:first-child {
    box-shadow: 0 1px 0 0 var(--token-color-border-primary), 0 -1px 0 0 var(--token-color-border-primary);
  }

  // we need this specificity to override the focus-ring mixin
  .hds-accordion-item__button.hds-accordion-item__button--parent-does-not-contain-interactive::before {
    border-radius: 0;
  }

  &.hds-accordion-item--does-not-contain-interactive:not(.hds-accordion-item--is-static) > .hds-disclosure-primitive__toggle {
    &:hover,
    &.mock-hover {
      .hds-accordion-item__toggle {
        background: var(--token-color-surface-interactive-hover);
      }
    }

    &:active,
    &.mock-active {
      .hds-accordion-item__toggle {
        background: var(--token-color-surface-interactive-active);
      }
    }
  }
}

.hds-accordion-item__toggle-content {
  .hds-accordion-item--is-static.hds-accordion-item--size-large & {
    margin-left: calc(var(--hds-accordion-item-icon-large) + var(--hds-accordion-item-gap));
  }

  .hds-accordion-item--is-static.hds-accordion-item--size-medium & {
    margin-left: calc(var(--hds-accordion-item-icon-medium) + var(--hds-accordion-item-gap));
  }

  .hds-accordion-item--is-static.hds-accordion-item--size-small & {
    margin-left: calc(var(--hds-accordion-item-icon-small) + var(--hds-accordion-item-gap));
  }
}

// TOGGLE BLOCK

.hds-accordion-item__toggle {
  position: relative;
  display: flex;
  gap: var(--hds-accordion-item-gap);
  align-items: center;

  .hds-accordion-item--size-large & {
    padding: var(--hds-accordion-item-padding-large) var(--hds-accordion-item-padding-large) var(--hds-accordion-item-padding-large) 12px;
  }

  .hds-accordion-item--size-medium & {
    padding: var(--hds-accordion-item-padding-medium) var(--hds-accordion-item-padding-medium) var(--hds-accordion-item-padding-medium) 12px;
  }

  .hds-accordion-item--size-small & {
    padding: var(--hds-accordion-item-padding-small) var(--hds-accordion-item-padding-small) var(--hds-accordion-item-padding-small) 12px;
  }
}

.hds-accordion-item__button {
  padding: 0;

  &:hover { cursor: pointer; }

  .flight-icon {
    @media (prefers-reduced-motion: no-preference) {
      transition: transform 0.3s;
    }
  }
}

// entire toggle area is interactive
.hds-accordion-item__button--parent-does-not-contain-interactive {
  @include hds-focus-ring-with-pseudo-element();
  position: static;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: -1px 0;
  color: var(--token-color-foreground-primary);
  background: transparent;
  border: 0;

  // expand button target to cover entire AccordionItem Toggle block (depending on the `@containsInteractive/@parentContainsInteractive` argument)
  &::after {
    position: absolute;
    display: block;
    border-radius: var(--hds-accordion-item-border-radius);
    content: "";
    inset: 0;
  }
}

// only chevron button area is interactive
.hds-accordion-item__button--parent-contains-interactive {
  @include hds-button();

  &:focus,
  &.mock-focus {
    @include hds-button-state-focus();
  }

  // `hds-button-color-secondary` determines the focus color and needs to be placed after `hds-button-state-focus`
  @include hds-button-color-secondary();
}

// animate chevron icon
.hds-accordion-item__button--is-open {
  .flight-icon-chevron-down {
    transform: rotate(-180deg);
  }
}

.hds-accordion-item__button--size-large {
  width: var(--hds-accordion-item-icon-large);
  height: var(--hds-accordion-item-icon-large);
}

.hds-accordion-item__button--size-medium {
  width: var(--hds-accordion-item-icon-medium);
  height: var(--hds-accordion-item-icon-medium);
}

.hds-accordion-item__button--size-small {
  width: var(--hds-accordion-item-icon-small);
  height: var(--hds-accordion-item-icon-small);
}

// Consumer added content that appears next to the chevron button:
.hds-accordion-item__toggle-content {
  flex: 1;
}

// CONTENT BLOCK

.hds-accordion-item__content {
  .hds-accordion-item--size-large & {
    padding: 4px var(--hds-accordion-item-padding-large) var(--hds-accordion-item-padding-large) var(--hds-accordion-item-padding-large);
  }

  .hds-accordion-item--size-medium & {
    padding: 4px var(--hds-accordion-item-padding-medium) var(--hds-accordion-item-padding-medium) var(--hds-accordion-item-padding-medium);
  }

  .hds-accordion-item--size-small & {
    padding: 4px var(--hds-accordion-item-padding-small) var(--hds-accordion-item-padding-small) var(--hds-accordion-item-padding-small);
  }
}
